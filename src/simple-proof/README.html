<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"><title>Simple DOT Proof | README</title><style></style>
        <style type="text/css">
         .tg  {border-collapse:collapse;border-spacing:0;border-color:#ccc;}
         .tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-color:#ccc;color:#333;background-color:#fff;border-top-width:1px;border-bottom-width:1px;}
         .tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;border-color:#ccc;color:#333;background-color:#f0f0f0;border-top-width:1px;border-bottom-width:1px;}
         .tg .tg-bq60{font-weight:bold;font-size:100%;font-family:Arial, Helvetica, sans-serif !important;;vertical-align:top}
         .tg .tg-rkwu{font-family:"Courier New", Courier, monospace !important;;vertical-align:top}
         .tg .tg-8fc1{font-weight:bold;font-family:Arial, Helvetica, sans-serif !important;;vertical-align:top}
         .tg .tg-yw4l{vertical-align:top}
        </style>
        <link href="doc/assets/resources/coqdoc.css" rel="stylesheet" type="text/css" />
        <link href="doc/assets/resources/coqdocjs.css" rel="stylesheet" type="text/css"/>
    </head>
    <body id="preview" class="readme">
        <div id="header">
            <span class="left">
                <span class="modulename"> README </span>
            </span>

            <span class="right">
                <a href="https://github.com/amaurremi/dot-calculus">Git repo</a>
                <a href="./README.html"> README</a>
                <a href="./doc/indexpage.html"> Index </a>
                <a href="./doc/toc.html"> Table of Contents </a>
            </span>
        </div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
        <h1><a id="A_Simple_Soundness_Proof_for_Dependent_Object_Types_0"></a>A Simple Soundness Proof for<br>Dependent Object Types</h1>

        <p>Our <a href="https://plg.uwaterloo.ca/~olhotak/pubs/oopsla17.pdf">paper</a> presents a simplified type-safety proof for the
            <a href="https://infoscience.epfl.ch/record/215280">version of DOT</a>
            presented at Wadlerfest 2016.
            This repository contains a formalization of the simple proof in Coq.
            The definitions of the abstract syntax and several lemmas are based on the
            <a href="https://github.com/samuelgruetter/dot-calculus/blob/master/dev/lf/dot_top_bot.v">original</a>
            Coq proof that comes with Wadlerfest DOT paper.</p>

        <p>This directory contains a Coq formalization of the DOT calculus and DOT's type safety proof.
          Our technique is based on eliminating bad bounds by using <i>inert types</i> and applying the <i>proof recipe</i>, as described in the OOPSLA'17
          <a href="https://plg.uwaterloo.ca/~olhotak/pubs/oopsla17.pdf">paper</a>.

          <h2>Documentation</h2>
        <p>
          The documentation can be accessed from the <a href="./doc/toc.html">table of contents</a>. This page
          lists links to pretty printed Coq source files, but the
          raw <code>.v</code> files can be found in the
          <a href="./proof/">proof</a> directory. In the
          pretty-printed versions, the proof scripts are hidden by default, you may
          click on "Show Proofs" at the top of the page to display all the
          proofs, or click under the Lemma or Theorem statements to display their
          proofs.
        </p>
        <h2><a id="Description_of_the_Proof_20"></a>Description of the Proof</h2>
        <p>This directory contains a Coq formalization of the DOT calculus and DOT's type safety proof
          using the method presented in the paper. The final Progress and Preservation proofs can
          be found in <a href="./doc/Safety.html">Safety.v</a>.</p>

        <h3>Proof Structure</h3>
        The Coq proof is split up into the following modules:
        <ul>
          <li><a href="doc/Definitions.html">Definitions.v</a>:
            The main inductive definitions and functions that are used in the proof.
            Defines the abstract syntax and type system.
          </li>
          <li><a href="doc/Binding.html">Binding.v</a>:
	    Proves helper lemmas related to opening, closing, and local closure.
          </li>
          <li><a href="doc/SubEnvironments.html">SubEnvironments.v</a>:
	    Defines and proves lemmas related to subenvironments.
          </li>
          <li><a href="doc/Weakening.html">Weakening.v</a>:
            Proves the Weakening Lemma.
          </li>
          <li><a href="doc/RecordAndInertTypes.html">RecordAndInertTypes.v</a>:
			Defines and proves lemmas related to record and inert types.
          </li>
          <li><a href="doc/Narrowing.html">Narrowing.v</a>:
            Proves the Narrowing Lemma.
          </li>
          <li><a href="doc/OperationalSemantics.html">OperationalSemantics.v</a>:
			Defines normal forms and the operational semantics of DOT, as well as related helper lemmas.
          </li>
          <li><a href="doc/PreciseTypes.html">PreciseTypes.v</a>:
            Defines and proves lemmas related to precise typing. In
			particular, reasons about the possible
            precise types that a variable can have in an inert environment.
          </li>
          <li><a href="doc/TightTypes.html">TightTypes.v</a>:
			Defines tight typing and subtyping.
          </li>
          <li><a href="doc/Substitution.html">Substitution.v</a>:
            Proves the Substitution Lemma.
          </li>
          <li><a href="doc/InvertibleTypes.html">InvertibleTypes.v</a>:
            Defines invertible typing and proves that in an inert context, tight typing implies invertible typing (both for variables and values).
          </li>
          <li><a href="doc/GeneralToTight.html">GeneralToTight.v</a>:
            Proves that in an inert context, general typing implies tight typing.
          </li>
          <li><a href="doc/CanonicalForms.html">CanonicalForms.v</a>:
            Proves the Canonical Forms Lemmas for functions and objects.
          </li>
          <li><a href="doc/Safety.html">Safety.v</a>:
            Proves the Progress and Preservation Theorems.
          </li>
        </ul>
        <p>The following figure shows a dependency graph between the Coq modules.</p>
        <p><center><img src=doc/graph.png width=400 alt="Please run 'make graph' in the proof directory to generate this graph."></center></p>

        <h3><a id="Paper_Correspondence_37"></a>Paper Correspondence</h3>
        <p>Below, we present a table that shows how the definitions and lemmas in the paper correspond
          to the Coq proof.
		</p>

        <table class="tg">
            <tr>
                <th class="tg-bq60" colspan="3">Paper<br></th>
                <th class="tg-8fc1" colspan="3">Coq Proof<br></th>
            </tr>
            <tr>
                <td class="tg-8fc1">Item</td>
                <td class="tg-8fc1">Description</td>
                <td class="tg-8fc1">Subitems</td>
                <td class="tg-8fc1">File</td>
                <td class="tg-8fc1">Name</td>
                <td class="tg-8fc1">Notation</td>
            </tr>
            <tr>
                <td class="tg-yw4l" rowspan="7">Figure 1<br></td>
                <td class="tg-yw4l" rowspan="7">DOT abstract syntax<br></td>
                <td class="tg-yw4l">variable</td>
                <td class="tg-yw4l" rowspan="7"><a href="doc/Definitions.html">Definitions.v</a></td>
                <td class="tg-rkwu">avar</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">term member<br></td>
                <td class="tg-rkwu">trm_label</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">type member<br></td>
                <td class="tg-rkwu">typ_label</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">term</td>
                <td class="tg-rkwu">trm</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">value</td>
                <td class="tg-rkwu">val</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">definition</td>
                <td class="tg-rkwu">def</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">type</td>
                <td class="tg-rkwu">typ</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l" rowspan="4">Figure 2<br></td>
                <td class="tg-yw4l" rowspan="4">DOT Type Rules<br></td>
                <td class="tg-yw4l">term typing<br></td>
                <td class="tg-yw4l" rowspan="4"><a href="doc/Definitions.html">Definitions.v</a></td>
                <td class="tg-rkwu">ty_trm</td>
                <td class="tg-rkwu">G ⊢ t : T</td>
            </tr>
            <tr>
                <td class="tg-yw4l">single-definition typing</td>
                <td class="tg-rkwu">ty_def</td>
                <td class="tg-rkwu">G ⊢ d : D</td>
            </tr>
            <tr>
                <td class="tg-yw4l">multiple-definition typing</td>
                <td class="tg-rkwu">ty_defs</td>
                <td class="tg-rkwu">G ⊢ ds :: T</td>
            </tr>
            <tr>
                <td class="tg-yw4l">subtyping<br></td>
                <td class="tg-rkwu">subtyp</td>
                <td class="tg-rkwu">G ⊢ T &lt;: U</td>
            </tr>
            <tr>
                <td class="tg-yw4l" rowspan="2">Figure 3<br></td>
                <td class="tg-yw4l" rowspan="2">Tight typing rules<br></td>
                <td class="tg-yw4l">term typing<br></td>
                <td class="tg-yw4l" rowspan="2"><a href="doc/TightTypes.html">TightTypes.v</a></td>
                <td class="tg-rkwu">ty_trm_t</td>
                <td class="tg-rkwu">G &vdash;<sub>&#35;</sub> t : T</td>
            </tr>
            <tr>
                <td class="tg-yw4l">subtyping<br></td>
                <td class="tg-rkwu">subtyp_t</td>
                <td class="tg-rkwu">G &vdash;<sub>&#35;</sub> T &lt;: U</td>
            </tr>
            <tr>
                <td class="tg-yw4l">Definition 3.1<br></td>
                <td class="tg-yw4l">Inert context<br></td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/RecordAndInertTypes.html">RecordAndInertTypes.v</a></td>
                <td class="tg-rkwu">inert</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Definition 3.2<br></td>
                <td class="tg-yw4l">Inert type<br></td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/RecordAndInertTypes.html">RecordAndInertTypes.v</a></td>
                <td class="tg-rkwu">inert_typ</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Figure 4<br></td>
                <td class="tg-yw4l">Precise typing rules<br></td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/PreciseTypes.html">PreciseTypes.v</a></td>
                <td class="tg-rkwu">ty_trm_p</td>
                <td class="tg-rkwu">G &vdash;<sub>!</sub> t : T</td>
            </tr>
            <tr>
                <td class="tg-yw4l">Theorem 3.3<br></td>
                <td class="tg-yw4l">General-to-tight typing (⊢ to ⊢<sub>#</sub>)</td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/GeneralToTight.html">GeneralToTight.v</a></td>
                <td class="tg-rkwu">general_to_tight</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Lemma 3.4<br></td>
                <td class="tg-yw4l">Sel-&lt;: replacement</td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/GeneralToTight.html">GeneralToTight.v</a><br></td>
                <td class="tg-rkwu">sel_replacement</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Lemma 3.5<br></td>
                <td class="tg-yw4l">Sel-&lt;:# premise<br></td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/GeneralToTight.html">GeneralToTight.v</a></td>
                <td class="tg-rkwu">sel_premise</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l" rowspan="2">Figure 5<br></td>
                <td class="tg-yw4l" rowspan="2">Invertible typing rules<br></td>
                <td class="tg-yw4l">for variables<br></td>
                <td class="tg-yw4l" rowspan="2"><a href="doc/InvertibleTypes.html">InvertibleTypes.v</a></td>
                <td class="tg-rkwu">ty_var_inv</td>
                <td class="tg-rkwu">G &vdash;<sub>&#35&#35</sub> x : T</td>
            </tr>
            <tr>
                <td class="tg-yw4l">for values<br></td>
                <td class="tg-rkwu">ty_val_inv</td>
                <td class="tg-rkwu">G &vdash;<sub>&#35&#35v</sub> v : T</td>
            </tr>
            <tr>
                <td class="tg-yw4l" rowspan="2">Theorem 3.6<br></td>
                <td class="tg-yw4l" rowspan="2">Tight-to-invertible typing (⊢<sub>#</sub> to ⊢<sub>##</sub>)</td>
                <td class="tg-yw4l">for variables<br></td>
                <td class="tg-yw4l" rowspan="2"><a href="doc/InvertibleTypes.html">InvertibleTypes.v</a></td>
                <td class="tg-rkwu">tight_to_invertible</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">for values<br></td>
                <td class="tg-rkwu">tight_to_invertible_v</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Lemma 3.7<br></td>
                <td class="tg-yw4l">∀ to Γ(x)</td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/CanonicalForms.html">CanonicalForms.v</a></td>
                <td class="tg-rkwu">var_typ_all_to_binds</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Lemma 3.8<br></td>
                <td class="tg-yw4l">∀ to λ</td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/CanonicalForms.html">CanonicalForms.v</a></td>
                <td class="tg-rkwu">val_typ_all_to_lambda</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Lemma 3.9<br></td>
                <td class="tg-yw4l">μ to Γ(x)</td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/CanonicalForms.html">CanonicalForms.v</a></td>
                <td class="tg-rkwu">var_typ_rcd_to_binds</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Lemma 3.10<br></td>
                <td class="tg-yw4l">μ to ν</td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/CanonicalForms.html">CanonicalForms.v</a></td>
                <td class="tg-rkwu">val_mu_to_new</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Lemma 3.11<br></td>
                <td class="tg-yw4l">Narrowing</td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/Narrowing.html">Narrowing.v</a></td>
                <td class="tg-rkwu">narrow_rules<br></td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Figure 7<br></td>
                <td class="tg-yw4l">Operational semantics<br></td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/OperationalSemantics.html">OperationalSemantics.v</a></td>
                <td class="tg-rkwu">red</td>
                <td class="tg-rkwu">e[t<sub>1</sub> ↦ t<sub>2</sub>]</td>
            </tr>
            <tr>
                <td class="tg-yw4l">Definition 3.12<br></td>
                <td class="tg-yw4l">Well-typed evaluation contexts with respect to a typing context</td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/Definitions.html">Definitions.v</a></td>
                <td class="tg-rkwu">well_typed</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Lemma 3.15<br></td>
                <td class="tg-yw4l">Value typing<br></td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/Safety.html">Safety.v</a></td>
                <td class="tg-rkwu">val_typing</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Definition 3.16<br></td>
                <td class="tg-yw4l">Normal form</td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/OperationalSemantics.html">OperationalSemantics.v</a></td>
                <td class="tg-rkwu">normal_form</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Theorem 3.17<br></td>
                <td class="tg-yw4l">Progress</td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/Safety.html">Safety.v</a></td>
                <td class="tg-rkwu">progress</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Theorem 3.18<br></td>
                <td class="tg-yw4l">Preservation</td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/Safety.html">Safety.v</a></td>
                <td class="tg-rkwu">preservation</td>
                <td class="tg-rkwu"></td>
            </tr>
            <tr>
                <td class="tg-yw4l">Lemma 3.19<br></td>
                <td class="tg-yw4l">Substitution</td>
                <td class="tg-yw4l"></td>
                <td class="tg-yw4l"><a href="doc/Substitution.html">Substitution.v</a></td>
                <td class="tg-rkwu">subst_ty_trm</td>
                <td class="tg-rkwu"></td>
            </tr>
        </table>

        <div>
            <h2>Compiling the Proof</h2>
            <p>
                To compile the proof, we require <code>coq 8.6</code> and related tooling
                to be run in a unix-like environment. In particular, we require
                the following tools (all version 8.6) in the <code>PATH</code>
                enviroment variable:
                <ul>
                    <li><code>coqc</code></li>
                    <li><code>coqtop</code></li>
                    <li><code>coqdep</code></li>
                    <li><code>coqdoc</code></li>
                    <li><code>coqmakefile</code></li>
                </ul>

                Other requirements are:
                <ul>
                    <li><code>make</code></li>
                    <li><code>sed</code></li>
                    <li><code>graphviz</code> (optional, requried for file/lemma dependency graph)</li>
                    <li><code>coq-dpdgraph</code> (optional, requried for lemma dependency graph)</li>
                    <li><code>grep</code> (optional, requried for lemma dependency graph)</li>
                    <li><code>paste</code> (optional, requried for lemma dependency graph)</li>
                    <li><code>xargs</code> (optional, requried for lemma dependency graph)</li>
                </ul>

            </p>
        </div>

        <p>
          To compile the proof, run

          <blockquote><code>git clone https://github.com/amaurremi/dot-calculus</code>
          <code>cd dot-calculus/src/simple-proof</code><br>
          <code>make</code></blockquote>

            This will do the following:
            <ul>
                <li>compile the <code>tlc</code> library;</li>
                <li>compile the safety proof;</li>
                <li>generate documentation.</li>
            </ul>
        </p>

    </div>

    </body>
</html>
